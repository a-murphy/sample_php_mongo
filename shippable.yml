language: php

php: 
  - 5.5
services:
  - mongodb
before_script: 
  - pecl install xdebug
  - ls /root/.phpenv/versions/$SHIPPABLE_PHP_VERSION/etc/
  - echo 'zend_extension="/usr/lib/php5/20121212/xdebug.so"' > /root/.phpenv/versions/$SHIPPABLE_PHP_VERSION/etc/php.ini
  - cat /root/.phpenv/versions/$SHIPPABLE_PHP_VERSION/etc/php.ini

  - composer self-update
  - composer install --no-progress --no-interaction --prefer-source
  
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage
script:
  - vendor/phpunit/phpunit/phpunit  --log-junit shippable/testresults/junit.xml --coverage-xml shippable/codecoverage -c phpunit.xml 
notifications:
   email:
     on_success: 'always'
