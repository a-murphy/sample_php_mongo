language: php

php: 
  - 5.5
  - 5.6
  
build:
  pre_ci_boot:
    image_name: amurphy/u14php
    image_tag: test
    pull: true
    options: "-e HOME=/root"
  ci:
    - export SHIPPABLE_PHP_RUNTIME="$SHIPPABLE_PHP_VERSION"
    - export PATH=$HOME/.phpenv/bin:$HOME/.phpenv/extensions:$PATH
    - eval "$(phpenv init -)"
    - /root/.phpenv/bin/phpenv global $SHIPPABLE_PHP_VERSION
    - php --version
    - composer self-update
    - composer install --no-progress --no-interaction --prefer-source
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - vendor/phpunit/phpunit/phpunit  --log-junit shippable/testresults/junit.xml --coverage-xml shippable/codecoverage -c phpunit.xml
